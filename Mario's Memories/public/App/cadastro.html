<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="cadastro.css">
    <title>Cadastro</title>
</head>
<body>
    <div class="cadastro">
        <div class="inputs_cadastro">
            <img src="./Logo/Perfil.png" alt="">
            <h1 class="titulo">Cadastre-se para Jogar!</h1>
            <input type="text" id="input_user" placeholder="Username"> <br><br>
            <input type="text" id="input_email" placeholder="Email"><br><br>
            <input type="password" id="input_senha" placeholder="Password"><br><br>
            <input type="password" id="input_confirmar" placeholder="Confirm Password"><br><br>
            <button onclick="cadastrar()">Cadastrar</button><br><br>
            <div class="texto-span">
                <span style="color: white;"> Já tem uma conta? </span><a href="./login.html" class="clique"
                    style="color: #E52521;">Faça o login aqui!</a>
            </div>
            <div class="voltar-site">
                <a href="./Site.html">Voltar</a>
            </div>
            <div id="mensagem"></div>
        </div>
        <img src="./elementos/luigilogin 1.png" class="luigi">
    </div>
</body>
</html>

<script>
    function cadastrar() {
        var nomeVar = input_user.value;
        var emailVar = input_email.value;
        var senhaVar = input_senha.value;

        if(nomeVar == "" || emailVar == "" || senhaVar == ""){
            alert("Nome, email ou senha não preenchido! Por favor preencha!")
        }
        else if(!emailVar.includes('@')){
            alert("O email inserido necessita de um '@'! ")
        }
        else if(senhaVar.length < 3 ){ 
         alert("A senha precisa ter 3 ou mais carácteres ")
        }
        else{


        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
              
                nomeServer: nomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    alert(
                        "Cadastro realizado com sucesso! Redirecionando para tela de Login...");

                    setTimeout(() => {
                        window.location = "login.html";
                    }, "2000");

                    limparFormulario();
                    finalizarAguardar();
                } else {
                    throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
                finalizarAguardar();
            });

        return false;
    }
}


</script>